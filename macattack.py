#!/usr/bin/env python3
import binascii
from sha1 import Sha1Hash

msg = [0x4e, 0x6f, 0x20, 0x6f, 0x6e, 0x65, 0x20, 0x68, 0x61, 0x73, 0x20, 0x63, 0x6f, 0x6d, 0x70, 0x6c,
       0x65, 0x74, 0x65, 0x64, 0x20, 0x6c, 0x61, 0x62, 0x20, 0x32, 0x20, 0x73, 0x6f, 0x20, 0x67, 0x69,
       0x76, 0x65, 0x20, 0x74, 0x68, 0x65, 0x6d, 0x20, 0x61, 0x6c, 0x6c, 0x20, 0x61, 0x20, 0x30]
msg_mac = [0xf4b645e8,
       0x9faaec2f,
       0xf8e443c5,
       0x95009c16,
       0xdbdfba4b]

test_mac = [0x91216ef0,
            0x0d38c421,
            0xfe0dfb9c,
            0x2d511347,
            0x6b78cd88]


def macattack(append_string, mac):
    return Sha1Hash(mac).update(bytes(append_string, 'utf-8')).hexdigest()

print(macattack(", except for Zack", test_mac))
